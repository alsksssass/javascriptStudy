/*
Chapter 38

### 문제 1
브라우저의 렌더링 과정을 최적화하는 예제를 작성하세요.

*/

// Your solution

## 리플로우

스타일 단계에서 구성되는 렌더 트리는 자바스크립트에 의해 DOM 트리, CSSOM 트리가 변경될 때 다시 재구성됨. DOM이 변경되거나 요소에 기하학적인 영향을 주는 CSS 속성 값을 변경하는 경우, 렌더 트리가 재구성되는 것.

즉, 레이아웃부터 이후 과정을 다시 수행하며 이것을 **리플로우** 라고 함.

## 리페인트

레이아웃에는 영향을 주지 않는 스타일 속성이 변경되면, 이는 페인트로부터 수행하기에 **리페인트**라고 함.

---
리플로우와 리페인트는 시간이 오래 걸리는 작업
그렇기 때문에 브라우저는 렌더링 과정에서 성능을 제일 많이 잡아먹음
따라서, **리플로우와 리페인트가 최소한으로 발생하도록 해야 최적화가 가능함!**

---
1. 블록 리소스 최적화
- <Head> 에서 CSS 파일 업로드
	- 문서 최상단에 CSS가 배치되게 해야 CSSOM 트리를 미리 구성할 수 있음
- <body> 직전에 자바스크립트 파일 로드
	- <script> 태그를 만나면 스크립트가 바로 실행되며 그 이전까지 생성된 DOM에만 접근할 수 있음.
	- 때문에 최하단에 배치해야 함

2. 사용하지 않는 노드에는 display: none 사용하기

3. 리플로우와 리페인트가 발생하는 속성 피하기
- left, right, width, height 보다 transform을, visibility / display 보다 opacitiy를 사용하는 것이 성능 개선에 도움이 됨.

4. 가상 노드 조작하기
- 요소에 변화를 줄 때는 DOM에 달려있는 채로 조작하는 것 보다 DOM에서 떼어낸 채로 조작하는 것이 효과적

``` javascript
const target = document.querySelector(".target");
const element = target.cloneNode(true);

...

target.replaceWith(element);
```

5. 레이아웃 스레싱 최적화
- 브라우저는 특정 기하학적인 속성 값을 읽으면 최신 값을 계산하기 위해 리플로우를 동기적으로 발생시킴
- 이를 '강제 동기 레이아웃'이라고 함
- 강제 동기 레이아웃이 발생하면 리플로우 계산을 위해 메인 스레드가 블락되므로 성능에 치명적
